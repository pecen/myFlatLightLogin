<UserControl
    x:Class="myFlatLightLogin.UI.Wpf.MVVM.View.ChangePassword"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converter="clr-namespace:myFlatLightLogin.UI.Wpf.Converter"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:extension="clr-namespace:myFlatLightLogin.UI.Wpf.Extension"
    xmlns:icon="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="clr-namespace:myFlatLightLogin.UI.Wpf.MVVM.ViewModel"
    d:DataContext="{d:DesignInstance Type=vm:ChangePasswordViewModel}"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
        <converter:InvertedBooleanToVisibilityConverter x:Key="InvertedBoolToVis" />
        <!-- Connection status colors -->
        <SolidColorBrush x:Key="OnlineColor" Color="#4CAF50" />
        <SolidColorBrush x:Key="OfflineColor" Color="#F44336" />
    </UserControl.Resources>

    <Grid>
        <Border
            Width="500"
            Padding="30"
            Background="White"
            BorderBrush="#e2e9e9"
            BorderThickness="2"
            CornerRadius="10">
            <StackPanel>
                <!--  Header  -->
                <TextBlock
                    Margin="0,0,0,20"
                    FontSize="28"
                    FontWeight="Bold"
                    Foreground="#ff131e"
                    Text="Change Password" />

                <!--  Connection Status  -->
                <StackPanel
                    Margin="0,0,0,20"
                    HorizontalAlignment="Left"
                    Orientation="Horizontal">
                    <!--  Status Circle with 3D effect  -->
                    <Ellipse
                        Width="12"
                        Height="12"
                        Margin="0,0,8,0"
                        VerticalAlignment="Center">
                        <Ellipse.Style>
                            <Style TargetType="Ellipse">
                                <Setter Property="Fill" Value="{StaticResource OfflineColor}" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsOnline}" Value="True">
                                        <Setter Property="Fill" Value="{StaticResource OnlineColor}" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Ellipse.Style>
                        <Ellipse.Effect>
                            <DropShadowEffect
                                BlurRadius="4"
                                Direction="315"
                                Opacity="0.5"
                                ShadowDepth="1"
                                Color="Black" />
                        </Ellipse.Effect>
                    </Ellipse>
                    <!--  Status Text  -->
                    <TextBlock
                        VerticalAlignment="Center"
                        FontSize="14"
                        FontWeight="SemiBold">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Foreground" Value="{StaticResource OfflineColor}" />
                                <Setter Property="Text" Value="Offline" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsOnline}" Value="True">
                                        <Setter Property="Foreground" Value="{StaticResource OnlineColor}" />
                                        <Setter Property="Text" Value="Online" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </StackPanel>

                <!--  Current Password  -->
                <TextBlock
                    Margin="0,10,0,5"
                    FontSize="14"
                    Foreground="#909090"
                    Text="Current Password" />
                <Grid Margin="0,0,0,15">
                    <PasswordBox
                        x:Name="CurrentPasswordBox"
                        Height="40"
                        FontSize="14"
                        extension:PasswordBoxExtensions.BoundPassword="{Binding CurrentPassword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Visibility="{Binding IsCurrentPasswordVisible, Converter={StaticResource InvertedBoolToVis}}" />
                    <TextBox
                        Height="40"
                        FontSize="14"
                        Text="{Binding CurrentPassword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Visibility="{Binding IsCurrentPasswordVisible, Converter={StaticResource BoolToVis}}" />
                    <Button
                        Width="30"
                        Height="30"
                        Margin="0,0,10,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Panel.ZIndex="2"
                        Background="Transparent"
                        BorderThickness="0"
                        Command="{Binding ToggleCurrentPasswordVisibilityCommand}"
                        Cursor="Hand"
                        ToolTip="Show/Hide Password">
                        <icon:PackIconMaterial
                            Width="16"
                            Height="16"
                            Foreground="#5a5a5a">
                            <icon:PackIconMaterial.Style>
                                <Style TargetType="icon:PackIconMaterial">
                                    <Setter Property="Kind" Value="EyeOutline" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsCurrentPasswordVisible}" Value="True">
                                            <Setter Property="Kind" Value="EyeOffOutline" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </icon:PackIconMaterial.Style>
                        </icon:PackIconMaterial>
                    </Button>
                </Grid>

                <!--  New Password  -->
                <TextBlock
                    Margin="0,10,0,5"
                    FontSize="14"
                    Foreground="#909090"
                    Text="New Password" />
                <Grid Margin="0,0,0,15">
                    <PasswordBox
                        x:Name="NewPasswordBox"
                        Height="40"
                        FontSize="14"
                        extension:PasswordBoxExtensions.BoundPassword="{Binding NewPassword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Visibility="{Binding IsNewPasswordVisible, Converter={StaticResource InvertedBoolToVis}}" />
                    <TextBox
                        Height="40"
                        FontSize="14"
                        Text="{Binding NewPassword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Visibility="{Binding IsNewPasswordVisible, Converter={StaticResource BoolToVis}}" />
                    <Button
                        Width="30"
                        Height="30"
                        Margin="0,0,10,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Panel.ZIndex="2"
                        Background="Transparent"
                        BorderThickness="0"
                        Command="{Binding ToggleNewPasswordVisibilityCommand}"
                        Cursor="Hand"
                        ToolTip="Show/Hide Password">
                        <icon:PackIconMaterial
                            Width="16"
                            Height="16"
                            Foreground="#5a5a5a">
                            <icon:PackIconMaterial.Style>
                                <Style TargetType="icon:PackIconMaterial">
                                    <Setter Property="Kind" Value="EyeOutline" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsNewPasswordVisible}" Value="True">
                                            <Setter Property="Kind" Value="EyeOffOutline" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </icon:PackIconMaterial.Style>
                        </icon:PackIconMaterial>
                    </Button>
                </Grid>

                <!--  Confirm New Password  -->
                <TextBlock
                    Margin="0,10,0,5"
                    FontSize="14"
                    Foreground="#909090"
                    Text="Confirm New Password" />
                <Grid Margin="0,0,0,20">
                    <PasswordBox
                        x:Name="ConfirmPasswordBox"
                        Height="40"
                        FontSize="14"
                        extension:PasswordBoxExtensions.BoundPassword="{Binding ConfirmPassword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Visibility="{Binding IsConfirmPasswordVisible, Converter={StaticResource InvertedBoolToVis}}" />
                    <TextBox
                        Height="40"
                        FontSize="14"
                        Text="{Binding ConfirmPassword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Visibility="{Binding IsConfirmPasswordVisible, Converter={StaticResource BoolToVis}}" />
                    <Button
                        Width="30"
                        Height="30"
                        Margin="0,0,10,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Panel.ZIndex="2"
                        Background="Transparent"
                        BorderThickness="0"
                        Command="{Binding ToggleConfirmPasswordVisibilityCommand}"
                        Cursor="Hand"
                        ToolTip="Show/Hide Password">
                        <icon:PackIconMaterial
                            Width="16"
                            Height="16"
                            Foreground="#5a5a5a">
                            <icon:PackIconMaterial.Style>
                                <Style TargetType="icon:PackIconMaterial">
                                    <Setter Property="Kind" Value="EyeOutline" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsConfirmPasswordVisible}" Value="True">
                                            <Setter Property="Kind" Value="EyeOffOutline" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </icon:PackIconMaterial.Style>
                        </icon:PackIconMaterial>
                    </Button>
                </Grid>

                <!--  Password Requirements  -->
                <TextBlock
                    Margin="0,0,0,20"
                    FontSize="12"
                    Foreground="#909090"
                    Text="Password must be at least 6 characters long."
                    TextWrapping="Wrap" />

                <!--  Buttons  -->
                <Grid Margin="0,10,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Button
                        Grid.Column="0"
                        Height="45"
                        Margin="0,0,5,0"
                        Background="#f0f0f0"
                        BorderThickness="0"
                        Command="{Binding CancelCommand}"
                        Content="Cancel"
                        FontSize="14"
                        Foreground="#606060" />

                    <Button
                        Grid.Column="1"
                        Height="45"
                        Margin="5,0,0,0"
                        Background="#ff131e"
                        BorderThickness="0"
                        Command="{Binding ChangePasswordCommand}"
                        Content="Change Password"
                        FontSize="14"
                        Foreground="White" />
                </Grid>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
